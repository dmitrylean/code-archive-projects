---
title: "–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –±—ç–∫—ç–Ω–¥–∞ –≤ React-–ø—Ä–æ–µ–∫—Ç"
category: "React"
---

## ‚öôÔ∏è –ü–æ—á–µ–º—É –≤—ã–Ω–æ—Å–∏—Ç—å backend ‚Äî —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

1. **Netlify –Ω–µ —Ç—Ä–∞—Ç–∏—Ç –±–∏–ª–¥—ã** ‚Äî –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–ª–∏ API –∂–∏–≤—ë—Ç –æ—Ç–¥–µ–ª—å–Ω–æ.
2. **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏** (Node, Deno, Supabase –∏ —Ç.–¥.).
3. **–ü—Ä–æ–µ–∫—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏** ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:

   > ‚ÄúFrontend ‚Äî Astro, backend ‚Äî Node/Express (–¥–µ–ø–ª–æ–π –Ω–∞ Render)‚Äù.

4. **–õ–µ–≥—á–µ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** ‚Äî –∫–∞–∂–¥—ã–π —Ä–µ–ø–æ –∫–∞–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å.

---

## üéÆ –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å —Ç–≤–æ–∏–º Game Portal

–¢—ã –≥–æ–≤–æ—Ä–∏–ª, —á—Ç–æ —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –µ–≥–æ ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–µ–≥–æ —É–∂–µ –∫–ª–∞—Å—Å–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è.
–í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –∫—É–¥–∞ –º–æ–∂–Ω–æ –¥–≤–∏–Ω—É—Ç—å –ø—Ä–æ–µ–∫—Ç:

---

### üí° –í–∞—Ä–∏–∞–Ω—Ç 1. **Game Scores API**

**–ò–¥–µ—è:** –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å Game Portal –≤ **–ø–æ—Ä—Ç–∞–ª —Å —Ä–µ–π—Ç–∏–Ω–≥–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ –∏ API –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- `/api/scores` ‚Äî CRUD –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `/api/players` ‚Äî —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
- `/api/leaderboard` ‚Äî —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤

**–§—Ä–æ–Ω—Ç:** —Ç–≤–æ–π React-–ø–æ—Ä—Ç–∞–ª, –≥–¥–µ –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–π—Ç–∏–Ω–≥.
**–ë—ç–∫:** Node.js (Express) –∏–ª–∏ Deno (Supabase + Edge Functions).

üì¶ –î–æ–±–∞–≤—å JWT –∏–ª–∏ –ø—Ä–æ—Å—Ç—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é ‚Äî –∏ –±—É–¥–µ—Ç ‚Äú–∏–≥—Ä–æ–≤–æ–π —Å–µ—Ä–≤–∏—Å —Å REST API‚Äù.

> ‚ÄúBuilt a gaming portal with a custom backend for player scores, authentication, and dynamic leaderboards.‚Äù

---

### üí° –í–∞—Ä–∏–∞–Ω—Ç 2. **Game News Aggregator**

**–ò–¥–µ—è:** –ø–æ—Ä—Ç–∞–ª –Ω–æ–≤–æ—Å—Ç–µ–π –æ –≤–∏–¥–µ–æ–∏–≥—Ä–∞—Ö, –∫–æ—Ç–æ—Ä—ã–π —Ç—è–Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö API (–Ω–∞–ø—Ä–∏–º–µ—Ä, RAWG.io –∏–ª–∏ IGN RSS).

**–§—Ä–æ–Ω—Ç:** React / Astro (—Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∫–∞—Ä—Ç–æ—á–∫–∏, –ø–æ–∏—Å–∫).
**–ë—ç–∫:** Node.js serverless —Ñ—É–Ω–∫—Ü–∏—è ‚Üí —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –≤–Ω–µ—à–Ω–∏—Ö API ‚Üí –∫—ç—à–∏—Ä—É–µ—Ç.

‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –±–∞–∑—ã, –º–æ–∂–Ω–æ –¥–µ–ø–ª–æ–∏—Ç—å —Ö–æ—Ç—å –Ω–∞ Cloudflare Workers.

> ‚ÄúBuilt a game news portal using React and serverless API integrations with data caching.‚Äù

---

### üí° –í–∞—Ä–∏–∞–Ω—Ç 3. **Mini Indie Game Launcher (UI + API)**

**–ò–¥–µ—è:** —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –∏–Ω–¥–∏-–∏–≥—Ä ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∏, –æ–ø–∏—Å–∞–Ω–∏—è, –¥–µ–º–æ, —Ä–µ–π—Ç–∏–Ω–≥.

**–§—Ä–æ–Ω—Ç:** React / Tailwind
**–ë—ç–∫:** Supabase (—Ç–∞–±–ª–∏—Ü–∞ `games`, `users`, `ratings`)
**API:** `/api/games`, `/api/rating`, `/api/user`

–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ñ–µ–π–∫–æ–≤—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (—á–µ—Ä–µ–∑ Supabase Auth)
–∏ –¥–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ-—Å–µ–∫—Ü–∏–∏ ‚ÄúPlay demo‚Äù ‚Äî –ø—Ä–æ—Å—Ç–æ –≤–∏–¥–µ–æ –∏–ª–∏ iframe.

> ‚ÄúCreated an indie game showcase platform with backend integration and rating system.‚Äù

---

## üîß –ì–¥–µ –≤—Å—ë —ç—Ç–æ —Ö–æ—Å—Ç–∏—Ç—å (–∏ –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—å –ª–∏–º–∏—Ç Netlify)

| –•–æ—Å—Ç–∏–Ω–≥                | –ß—Ç–æ —Ç—É–¥–∞ —Å—Ç–∞–≤–∏—Ç—å               | –ü–æ—á–µ–º—É –∫–ª–∞—Å—Å–Ω–æ                                          |
| ---------------------- | ------------------------------ | ------------------------------------------------------- |
| **Render.com**         | Node.js API / Express / SQLite | Free tier, auto-deploy –∏–∑ GitHub                        |
| **Railway.app**        | Node.js API / PostgreSQL       | –õ–µ–≥–∫–∏–π –¥–µ–ø–ª–æ–π, –∞–≤—Ç–æ CI/CD                               |
| **Cloudflare Workers** | Edge-—Ñ—É–Ω–∫—Ü–∏–∏                   | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ, —Å—É–ø–µ—Ä–¥–µ—à–µ–≤–æ, –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–∞ |
| **Supabase**           | Backend-as-a-Service           | –ë–î + Auth + Storage, –±–µ—Å–ø–ª–∞—Ç–Ω–æ                          |
| **Deno Deploy**        | Serverless API                 | –ë—ã—Å—Ç—Ä–æ, –∏–¥–µ–∞–ª—å–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Astro                  |

---

## üî© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Ç—Ä—é–∫

–ß—Ç–æ–±—ã –Ω–µ –≥–æ—Ä–æ–¥–∏—Ç—å –º–æ–Ω–æ—Ä–µ–ø–æ –∏ –ø—Ä–∏ —ç—Ç–æ–º –ª–µ–≥–∫–æ —Å–≤—è–∑—ã–≤–∞—Ç—å —Ñ—Ä–æ–Ω—Ç –∏ –±—ç–∫:

1. –°–æ–∑–¥–∞–π –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ `game-portal-api`
2. –í `.env` –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ñ—Ä–æ–Ω—Ç–∞ (`game-portal`) —É–∫–∞–∂–∏ `VITE_API_URL=https://game-api.onrender.com`
3. –¢–µ–ø–µ—Ä—å —Ñ—Ä–æ–Ω—Ç —Ç—è–Ω–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –≤–Ω–µ—à–Ω–µ–≥–æ API, –∏ –±–∏–ª–¥—ã Netlify –Ω–µ —Å—Ç—Ä–∞–¥–∞—é—Ç üöÄ

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å **–∏–≥—Ä–æ–≤—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É**, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:

1. –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –∫–∞—Ä—Ç—É, –∫—Ä–∏–ø—Ç—É –∏–ª–∏ Steam Gift)
2. –ö—É–ø–∏—Ç—å –∏–≥—Ä–æ–≤—ã–µ –∫–ª—é—á–∏
3. –ö—É–ø–∏—Ç—å / –ø—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –∏–∑ –∏–≥—Ä

---

## üß© –†–∞–∑–±–æ—Ä –ø–æ –±–ª–æ–∫–∞–º

### 1Ô∏è‚É£ **–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ Steam-–±–∞–ª–∞–Ω—Å–∞**

–¢—ã —Å–∫–∞–∑–∞–ª: ‚Äú—Å –ø–µ—Ä–≤—ã–º –±–æ–ª–µ–µ-–º–µ–Ω–µ–µ –ø–æ–Ω—è—Ç–Ω–æ‚Äù ‚Äî –∏ —Ç—ã –ø—Ä–∞–≤.

–ï—Å—Ç—å 2 –ø—É—Ç–∏:

#### ‚úÖ _–ë–µ–ª—ã–π –ø—É—Ç—å (API + —Ä–µ—Å–µ–ª–ª–µ—Ä—ã)_

- **Steam Gifts** ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –≥–∏—Ñ—Ç-–∫–æ–¥—ã —á–µ—Ä–µ–∑ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–æ–≤.
- **–ü–ª–∞—Ç—ë–∂–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä—ã** –≤—Ä–æ–¥–µ **Unitpay**, **FreeKassa**, **Interkassa**, **CryptoCloud**, **NowPayments**.
- –¢–≤–æ—è —Ä–æ–ª—å: –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–ø–ª–∞—Ç—É, –≤—ã–¥–∞–≤–∞—Ç—å –∫–æ–¥ (–≥–¥–µ —Ç—ã –ø–æ–∫—É–ø–∞–µ—à—å ‚Äî —É –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤).

üß† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏:

- –§—Ä–æ–Ω—Ç: Astro / React
- –ë—ç–∫: Node + Express
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/api/payment` ‚Üí –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç—ë–∂–∫–æ–π
- –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã ‚Üí `/api/gift/redeem` ‚Üí –≤—ã–¥–∞—Ç—å –∫–ª—é—á (–∏–∑ –±–∞–∑—ã)

#### ‚öôÔ∏è _–°–µ—Ä—ã–π –ø—É—Ç—å (–≤—Ä—É—á–Ω—É—é, —á–µ—Ä–µ–∑ API —Å—Ç–∏–º-–≥—Ä—É–ø–ø—ã)_

- –ú–æ–∂–Ω–æ —á–µ—Ä–µ–∑ SteamBot (–±–æ—Ç–∞) –ø–µ—Ä–µ—Å—ã–ª–∞—Ç—å –≥–∏—Ñ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.
- –ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω—ã **–∞–∫–∫–∞—É–Ω—Ç—ã-–±–æ—Ç—ã, –∫–æ—à–µ–ª—å–∫–∏ –∏ VPN**, –∏ —ç—Ç–æ —É–∂–µ –∑–æ–Ω–∞ ‚Äú–Ω–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞‚Äù.

---

### 2Ô∏è‚É£ **–ü—Ä–æ–¥–∞–∂–∞ –∫–ª—é—á–µ–π (Steam, Origin, Uplay –∏ —Ç.–¥.)**

–í–æ—Ç —Ç—É—Ç –≤—Å—ë –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ.

#### üí° –ö–∞–∫ —ç—Ç–æ –¥–µ–ª–∞—é—Ç –ª–µ–≥–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–æ—Ä—ã:

1. –ë–µ—Ä—É—Ç –∫–ª—é—á–∏ —É **–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ—Å–µ–ª–ª–µ—Ä–æ–≤** (Humble, GreenManGaming, Fanatical, G2A API –∏ —Ç.–¥.)
2. –ü–æ–¥–∫–ª—é—á–∞—é—Ç **–∏—Ö API** –∫ —Å–≤–æ–µ–º—É —Å–∞–π—Ç—É
3. –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–∞—Ç–∞–ª–æ–≥ ‚Üí –∫–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç ‚Üí —Ç–≤–æ–π –±—ç–∫ —Ç—è–Ω–µ—Ç –∫–ª—é—á —á–µ—Ä–µ–∑ API ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î ‚Üí –≤—ã–¥–∞–µ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—é.

üì¶ **–ü—Ä–∏–º–µ—Ä API:**

- [G2A API](https://www.g2a.co/api/)
- [Kinguin API](https://www.kinguin.net/developer/)
- [Eneba API (–Ω–µ –ø—É–±–ª–∏—á–Ω—ã–π, –Ω–æ –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –ø–∞—Ä—Å–∏–Ω–≥)]
- [GreenManGaming API](https://www.greenmangaming.com/)

üß† –î–ª—è MVP –º–æ–∂–Ω–æ:

- —Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–∏ –≤—Ä—É—á–Ω—É—é –≤ –ë–î (sqlite/postgres)
- –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã ‚Üí –≤—ã–¥–∞–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –∫–ª—é—á
- –æ—Ç–º–µ—á–∞—Ç—å –∫–∞–∫ ‚Äú–ø—Ä–æ–¥–∞–Ω–Ω—ã–π‚Äù

–¢–∞–∫ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–∞–±–æ—á–∏–π **‚Äú–º–∏–Ω–∏-–º–∞–≥–∞–∑–∏–Ω –∫–ª—é—á–µ–π‚Äù** –±–µ–∑ API, –∞ –ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ API –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞.

---

### 3Ô∏è‚É£ **–ü—Ä–µ–¥–º–µ—Ç—ã –∏–∑ –∏–≥—Ä (—Å–∫–∏–Ω—ã, –≤–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤—ã–µ –≤–µ—â–∏)**

–¢—É—Ç –¥–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è:

#### ‚öôÔ∏è _–ò–≥—Ä—ã —Å –æ—Ç–∫—Ä—ã—Ç–æ–π —ç–∫–æ–Ω–æ–º–∏–∫–æ–π (CS2, Dota2, TF2)_

–¢–∞–º –≤—Å—ë —á–µ—Ä–µ–∑ **Steam Inventory API** –∏–ª–∏ **Steam Marketplace API**.
–¢—ã –º–æ–∂–µ—à—å:

- –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –¥–µ–ª–∞—Ç—å ‚Äú–æ—Ü–µ–Ω–∫—É‚Äù –ø—Ä–µ–¥–º–µ—Ç–∞ –ø–æ —Ä—ã–Ω–æ—á–Ω–æ–π —Ü–µ–Ω–µ (—á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ API –≤—Ä–æ–¥–µ CSGOFloat, SteamApis.com)
- –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –æ–±–º–µ–Ω —á–µ—Ä–µ–∑ **Steam Trade Offers API** (—Ç—Ä–µ–±—É–µ—Ç API key –∏ –±–æ—Ç-–∞–∫–∫–∞—É–Ω—Ç—ã)

#### ‚ö†Ô∏è _–ù–æ –≤–∞–∂–Ω–æ:_

Valve –æ—á–µ–Ω—å —Å—Ç—Ä–æ–≥–æ —Å–ª–µ–¥–∏—Ç –∑–∞ –±–æ—Ç–∞–º–∏ –∏ ‚Äú—Ç–æ—Ä–≥–æ–≤—ã–º–∏ —Å–∞–π—Ç–∞–º–∏‚Äù.
–ï—Å–ª–∏ —Ç—ã –Ω–µ –¥–µ–ª–∞–µ—à—å —Å–µ—Ä—ã–π —Ä—ã–Ω–æ–∫ ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ **–æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–µ —Ü–µ–Ω—ã –∏ –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–¥–∞–∂**, –±–µ–∑ –ø—Ä—è–º—ã—Ö –æ–±–º–µ–Ω–æ–≤.

---

## üß† –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å MVP (–∏ –æ—Å—Ç–∞—Ç—å—Å—è –≤ –ª–µ–≥–∞–ª—å–Ω–æ–º –ø–æ–ª–µ)

1. **Frontend:** React / Astro (—Å—Ç—Ä–∞–Ω–∏—Ü—ã: –∫–∞—Ç–∞–ª–æ–≥, –ø–æ–∫—É–ø–∫–∞, –æ–ø–ª–∞—Ç–∞, –≤—ã–¥–∞—á–∞ –∫–ª—é—á–∞)

2. **Backend:** Node.js (Express + SQLite)

3. **API-–º–æ–¥–µ–ª–∏:**

   ```js
   /api/products      // —Å–ø–∏—Å–æ–∫ –∏–≥—Ä
   /api/payment       // —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
   /api/payment/success // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–ª–±—ç–∫–∞ –æ—Ç –ø–ª–∞—Ç–µ–∂–∫–∏
   /api/key/redeem    // –≤—ã–¥–∞—á–∞ –∫–ª—é—á–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
   ```

4. **–ë–∞–∑–∞:**
   - `products` (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, —Ç–∏–ø, stock)
   - `keys` (product_id, key, is_sold)
   - `orders` (user_email, product_id, payment_status)

5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - –ø–ª–∞—Ç—ë–∂–∫–∞ ‚Üí —Ç–≤–æ–π –±–µ–∫—ç–Ω–¥ ‚Üí –≤—ã–¥–∞—á–∞ –∫–ª—é—á–∞
   - –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å ‚Äú—Ä—É—á–Ω–æ–≥–æ‚Äù –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–µ–π

---

## üß© 1. –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å —Å–∞–º–∏ –∫–ª—é—á–∏

–¢—É—Ç –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å –æ–¥–Ω—É –≤–µ—â—å:
**–∫–ª—é—á = –¥–µ–Ω—å–≥–∏**.
–ö–∞–∂–¥—ã–π –∫–ª—é—á ‚Äî —ç—Ç–æ, –ø–æ —Å—É—Ç–∏, —Ü–∏—Ñ—Ä–æ–≤–æ–π —Ç–æ–≤–∞—Ä, –∏ —Ç—ã –Ω–µ —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã –∫—Ç–æ-—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã–ª `/api/keys` –∏ —Å–ø—ë—Ä –≤–µ—Å—å —Ç–≤–æ–π ‚Äú–∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç‚Äù.

–ü–æ—ç—Ç–æ–º—É:

- –∫–ª—é—á–∏ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –ª–µ–∂–∞—Ç—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ –ë–î**;
- —Ç—ã **–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å –∏—Ö –Ω–∞–ø—Ä—è–º—É—é –ø–æ API**, –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä–∏–ª –æ–ø–ª–∞—Ç—É;
- –∏ –¥–∞–∂–µ –≤ –∞–¥–º–∏–Ω–∫–µ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã**.

---

### üíæ –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

| –ü–æ–ª–µ          | –¢–∏–ø       | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ             |
| ------------- | --------- | ---------------------- |
| id            | int       | Primary key            |
| product_id    | int       | –°—Å—ã–ª–∫–∞ –Ω–∞ –∏–≥—Ä—É         |
| key_encrypted | text      | AES-–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á |
| is_sold       | boolean   | 0/1                    |
| sold_at       | timestamp | –∫–æ–≥–¥–∞ –ø—Ä–æ–¥–∞–Ω           |

---

### üîê –ü—Ä–∏–º–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (Node.js + Crypto)

```js
import crypto from "crypto";

const ALGO = "aes-256-ctr";
const SECRET = process.env.KEY_SECRET;

export const encrypt = (text) => {
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv(ALGO, Buffer.from(SECRET, "hex"), iv);
  const encrypted = Buffer.concat([cipher.update(text), cipher.final()]);
  return iv.toString("hex") + ":" + encrypted.toString("hex");
};

export const decrypt = (hash) => {
  const [iv, content] = hash.split(":");
  const decipher = crypto.createDecipheriv(
    ALGO,
    Buffer.from(SECRET, "hex"),
    Buffer.from(iv, "hex"),
  );
  const decrypted = Buffer.concat([
    decipher.update(Buffer.from(content, "hex")),
    decipher.final(),
  ]);
  return decrypted.toString();
};
```

–¢–∞–∫ —Ç—ã –º–æ–∂–µ—à—å —Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–∏ –≤ –ë–î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ª—É—á–∏—Ç –¥–∞–º–ø, –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –Ω–∏—á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ `KEY_SECRET`.

---

## üß± 2. –ì–¥–µ –¥–µ—Ä–∂–∞—Ç—å –ë–î (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–ª–∏—Ç—å –ª–∏–º–∏—Ç—ã Netlify)

–í–æ—Ç —Ç–≤–æ–π ‚Äú–∑–æ–ª–æ—Ç–æ–π –≤—ã–±–æ—Ä‚Äù –¥–ª—è –ª—ë–≥–∫–∏—Ö, –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö backend-—Ä–µ—à–µ–Ω–∏–π:

| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞       | –¢–∏–ø                   | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                              |
| --------------- | --------------------- | ---------------------------------------- |
| **Supabase**    | PostgreSQL + Auth     | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 500 –ú–ë, REST API –∏–∑ –∫–æ—Ä–æ–±–∫–∏ |
| **Railway.app** | PostgreSQL / MySQL    | –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –¥–µ–ø–ª–æ–π, auto CI/CD         |
| **Render.com**  | PostgreSQL + Node     | –ú–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –±–µ–∫ –∏ –±–∞–∑—É —Ä—è–¥–æ–º        |
| **Neon.tech**   | PostgreSQL serverless | –ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ            |
| **PlanetScale** | MySQL serverless      | –ù–∞–¥—ë–∂–Ω–æ, –Ω–æ —á—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ     |

---

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: **Supabase**

–ü–æ—Ç–æ–º—É —á—Ç–æ:

- —É —Ç–µ–±—è —É–∂–µ JS-—ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ (–ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å),
- –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã `products`, `keys`, `orders`,
- REST –∏ GraphQL API –∏–¥—É—Ç ‚Äú–∏–∑ –∫–æ—Ä–æ–±–∫–∏‚Äù,
- –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (Google, GitHub, Email),
- –≤—Å—ë –±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 500 –ú–ë.

---

## üß† 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ ‚Äú–º–∞–≥–∞–∑–∏–Ω–∞ –∫–ª—é—á–µ–π‚Äù

```
üì¶ game-keys-store
 ‚î£ üìÅ frontend (Astro / React)
 ‚î£ üìÅ backend (Node.js + Express)
 ‚î£ üìÑ .env
 ‚î£ üìÑ package.json
 ‚îó üìÑ README.md
```

### API

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç               | –û–ø–∏—Å–∞–Ω–∏–µ                           |
| ----- | ---------------------- | ---------------------------------- |
| GET   | `/api/products`        | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä                |
| POST  | `/api/order`           | –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑, —Ä–µ–¥–∏—Ä–µ–∫—Ç –≤ –ø–ª–∞—Ç—ë–∂–∫—É |
| POST  | `/api/payment/webhook` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã                   |
| GET   | `/api/order/:id/key`   | –í—ã–¥–∞—Ç—å –∫–ª—é—á –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è    |

---

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

1. üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∏–≥—Ä—É ‚Üí –Ω–∞–∂–∏–º–∞–µ—Ç ‚Äú–ö—É–ø–∏—Ç—å‚Äù
2. üí∞ –ë—ç–∫ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ –ø–ª–∞—Ç—ë–∂–∫—É
3. ‚öôÔ∏è –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã ‚Üí –ø–ª–∞—Ç—ë–∂–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `/api/payment/webhook`
4. üß† –ë—ç–∫:
   - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `is_paid = true`
   - –¥–æ—Å—Ç–∞—ë—Ç **–ø–µ—Ä–≤—ã–π –Ω–µ –ø—Ä–æ–¥–∞–Ω–Ω—ã–π –∫–ª—é—á**
   - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –µ–≥–æ
   - –ø–æ–º–µ—á–∞–µ—Ç –∫–∞–∫ `sold = true`
   - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞

5. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∫–ª—é—á –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∏–ª–∏ –ø–æ email.

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞

- –•—Ä–∞–Ω–∏ `KEY_SECRET` –∏ –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –∫–ª—é—á–∏ —Ç–æ–ª—å–∫–æ –≤ `.env`
- –ù–µ –¥–µ—Ä–∂–∏ –∞–¥–º–∏–Ω–∫—É –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–π —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π –ø–æ API
- –°–¥–µ–ª–∞–π –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API (rate limiting)

---

## ‚òÅÔ∏è –ì–¥–µ –≤—Å—ë —ç—Ç–æ –¥–µ–ø–ª–æ–∏—Ç—å

- **Frontend (Astro/React)** ‚Äî –Ω–∞ Netlify (—É–∂–µ –µ—Å—Ç—å)
- **Backend (Node API)** ‚Äî –Ω–∞ Render / Railway / Cloudflare Workers
- **Database (Supabase / Neon)** ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ, –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `DATABASE_URL`

---

## üß± –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–í–æ—Ç –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä—É—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è fullstack-–ø—Ä–æ–µ–∫—Ç–æ–≤ —Å Astro / React + Node + Supabase:

```
üì¶ game-keys-store
 ‚î£ üìÅ frontend/              # Astro –∏–ª–∏ React
 ‚îÉ ‚î£ üìÅ src/
 ‚îÉ ‚î£ üìÅ public/
 ‚îÉ ‚îó üìÑ package.json
 ‚î£ üìÅ backend/               # Express + API
 ‚îÉ ‚î£ üìÅ src/
 ‚îÉ ‚îÉ ‚î£ üìÅ routes/            # /api/products, /api/order, /api/key
 ‚îÉ ‚îÉ ‚î£ üìÅ services/          # —Ä–∞–±–æ—Ç–∞ —Å –ë–î –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
 ‚îÉ ‚îÉ ‚î£ üìÅ utils/             # —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, helpers, middlewares
 ‚îÉ ‚îÉ ‚îó üìÑ server.js          # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ Express
 ‚îÉ ‚î£ üìÑ package.json
 ‚îÉ ‚î£ üìÑ .env
 ‚îÉ ‚îó üìÑ README.md
 ‚î£ üìÑ .gitignore
 ‚î£ üìÑ README.md
 ‚îó üìÑ .env.example
```

---

## ‚öôÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî –û—Ç–¥–µ–ª—å–Ω—ã–π `backend` –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ —Ç—ã –¥–µ–ø–ª–æ–∏—à—å –µ–≥–æ, —Å–∫–∞–∂–µ–º, –Ω–∞ **Render** –∏–ª–∏ **Railway**, —Ç–æ:

- –∑–∞—Ö–æ–¥–∏—à—å –≤ `backend/`
- –¥–µ–ª–∞–µ—à—å `npm init`
- —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—à—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

  ```bash
  npm install express dotenv cors
  ```

- —Å–æ–∑–¥–∞—ë—à—å `src/server.js`

```js
// backend/src/server.js
import express from "express";
import cors from "cors";
import dotenv from "dotenv";
dotenv.config();

const app = express();
app.use(cors());
app.use(express.json());

// Example route
app.get("/", (req, res) => {
  res.json({ message: "API is running üöÄ" });
});

// Start server
const PORT = process.env.PORT || 5000;
app.listen(PORT, () => console.log(`Server running on port ${PORT}`));
```

–ü–æ—Ç–æ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å:

- `src/routes/products.js`
- `src/routes/orders.js`
- `src/routes/keys.js`

–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∏—Ö –≤ `server.js`.

---

## ‚öôÔ∏è –í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî Monorepo, –Ω–æ —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –±–∏–ª–¥-–∫–æ–º–∞–Ω–¥–∞–º–∏

–ï—Å–ª–∏ —Ç—ã –≤—Å—ë-—Ç–∞–∫–∏ –¥–µ—Ä–∂–∏—à—å —Ñ—Ä–æ–Ω—Ç –∏ –±—ç–∫ –≤ –æ–¥–Ω–æ–º —Ä–µ–ø–æ, —Ç–æ –¥–æ–±–∞–≤—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π `package.json`:

```json
{
  "name": "game-keys-store",
  "workspaces": ["frontend", "backend"]
}
```

–ê –¥–ª—è –¥–µ–ø–ª–æ—è —Å–¥–µ–ª–∞–π —Ç–∞–∫:

- **Netlify**: —É–∫–∞–∑—ã–≤–∞–µ—à—å –ø—É—Ç—å –∫ `frontend`
- **Render / Railway**: —É–∫–∞–∑—ã–≤–∞–µ—à—å –ø—É—Ç—å –∫ `backend`

–¢–∞–∫ –æ–Ω–∏ –±—É–¥—É—Ç —Å–æ–±–∏—Ä–∞—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
–ú–æ–Ω–æ—Ä–µ–ø–æ –æ—Å—Ç–∞—ë—Ç—Å—è, –Ω–æ Netlify –Ω–µ –±—É–¥–µ—Ç —Ç—Ä–∞—Ç–∏—Ç—å –º–∏–Ω—É—Ç—ã –Ω–∞ –±—ç–∫.

---

## üìÅ –ö—É–¥–∞ –∫–∏–¥–∞—Ç—å Express?

üëâ –í—Å–µ–≥–¥–∞ **–≤–Ω—É—Ç—Ä—å –ø–∞–ø–∫–∏ `backend/src/`**, —Å —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ `server.js` –∏–ª–∏ `index.js`.
–≠—Ç–æ:

- —á–∏—Å—Ç–æ,
- –≥–∏–±–∫–æ,
- –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è.

---

## üí° –ë–æ–Ω—É—Å: –ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `routes/`

```
backend/
 ‚î£ src/
 ‚îÉ ‚î£ routes/
 ‚îÉ ‚îÉ ‚î£ products.js
 ‚îÉ ‚îÉ ‚î£ order.js
 ‚îÉ ‚îÉ ‚îó key.js
 ‚îÉ ‚î£ services/
 ‚îÉ ‚îÉ ‚îó supabase.js
 ‚îÉ ‚î£ utils/
 ‚îÉ ‚îÉ ‚î£ crypto.js
 ‚îÉ ‚îÉ ‚îó validatePayment.js
 ‚îÉ ‚îó server.js
 ‚î£ package.json
 ‚îó .env
```

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
 ‚î£ üìÅ src/
 ‚îÉ ‚î£ üìÅ routes/
 ‚îÉ ‚îÉ ‚î£ products.js        # —Å–ø–∏—Å–æ–∫ –∏–≥—Ä
 ‚îÉ ‚îÉ ‚î£ order.js           # —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ / –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã
 ‚îÉ ‚îÉ ‚îó key.js             # –≤—ã–¥–∞—á–∞ –∫–ª—é—á–µ–π
 ‚îÉ ‚î£ üìÅ services/
 ‚îÉ ‚îÉ ‚îó supabase.js        # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î Supabase
 ‚îÉ ‚î£ üìÅ utils/
 ‚îÉ ‚îÉ ‚î£ crypto.js          # —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π
 ‚îÉ ‚îÉ ‚îó validatePayment.js # –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
 ‚îÉ ‚îó üìÑ server.js          # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ Express
 ‚î£ üìÑ .env
 ‚î£ üìÑ package.json
 ‚îó üìÑ README.md
```

---

## üß∞ 1. package.json

```json
{
  "name": "game-keys-backend",
  "version": "1.0.0",
  "type": "module",
  "main": "src/server.js",
  "scripts": {
    "start": "node src/server.js",
    "dev": "nodemon src/server.js"
  },
  "dependencies": {
    "cors": "^2.8.5",
    "dotenv": "^16.4.1",
    "express": "^4.19.2",
    "@supabase/supabase-js": "^2.43.4"
  },
  "devDependencies": {
    "nodemon": "^3.0.3"
  }
}
```

---

## ‚öôÔ∏è 2. .env

```bash
PORT=5000
SUPABASE_URL=https://YOUR_PROJECT.supabase.co
SUPABASE_KEY=YOUR_SUPABASE_SERVICE_ROLE_KEY
KEY_SECRET=YOUR_64_HEX_SECRET_KEY
```

üëâ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `KEY_SECRET`:

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

---

## üöÄ 3. src/server.js

```js
import express from "express";
import cors from "cors";
import dotenv from "dotenv";
dotenv.config();

import productRoutes from "./routes/products.js";
import orderRoutes from "./routes/order.js";
import keyRoutes from "./routes/key.js";

const app = express();
app.use(cors());
app.use(express.json());

// API routes
app.use("/api/products", productRoutes);
app.use("/api/order", orderRoutes);
app.use("/api/key", keyRoutes);

const PORT = process.env.PORT || 5000;
app.listen(PORT, () => console.log(`üöÄ Backend running on port ${PORT}`));
```

---

## üéÆ 4. src/routes/products.js

```js
import express from "express";
import { supabase } from "../services/supabase.js";
const router = express.Router();

// Get all games
router.get("/", async (req, res) => {
  const { data, error } = await supabase.from("products").select("*");
  if (error) return res.status(500).json({ error: error.message });
  res.json(data);
});

export default router;
```

---

## üí∞ 5. src/routes/order.js

```js
import express from "express";
import { supabase } from "../services/supabase.js";
import validatePayment from "../utils/validatePayment.js";
const router = express.Router();

// Create order (simplified)
router.post("/", async (req, res) => {
  const { product_id, email } = req.body;

  const { data: product } = await supabase
    .from("products")
    .select("*")
    .eq("id", product_id)
    .single();

  if (!product) return res.status(404).json({ error: "Product not found" });

  // TODO: redirect to payment provider
  const order = {
    product_id,
    email,
    status: "pending",
  };

  const { data, error } = await supabase
    .from("orders")
    .insert(order)
    .select()
    .single();
  if (error) return res.status(500).json({ error: error.message });

  res.json({ message: "Order created", order: data });
});

// Payment webhook (simplified)
router.post("/webhook", async (req, res) => {
  const valid = validatePayment(req.body);
  if (!valid) return res.status(400).json({ error: "Invalid signature" });

  const { order_id } = req.body;
  await supabase.from("orders").update({ status: "paid" }).eq("id", order_id);

  res.json({ message: "Payment confirmed" });
});

export default router;
```

---

## üîë 6. src/routes/key.js

```js
import express from "express";
import { supabase } from "../services/supabase.js";
import { decrypt } from "../utils/crypto.js";
const router = express.Router();

// Redeem key after successful payment
router.get("/:order_id/redeem", async (req, res) => {
  const { order_id } = req.params;

  const { data: order } = await supabase
    .from("orders")
    .select("*")
    .eq("id", order_id)
    .eq("status", "paid")
    .single();

  if (!order)
    return res.status(404).json({ error: "Order not found or not paid" });

  const { data: key } = await supabase
    .from("keys")
    .select("*")
    .eq("product_id", order.product_id)
    .eq("is_sold", false)
    .limit(1)
    .single();

  if (!key) return res.status(404).json({ error: "No available keys" });

  const decrypted = decrypt(key.key_encrypted);

  // mark as sold
  await supabase
    .from("keys")
    .update({ is_sold: true, sold_at: new Date() })
    .eq("id", key.id);

  res.json({ key: decrypted });
});

export default router;
```

---

## üß† 7. src/services/supabase.js

```js
import { createClient } from "@supabase/supabase-js";

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_KEY,
);

export { supabase };
```

---

## üîê 8. src/utils/crypto.js

```js
import crypto from "crypto";

const ALGO = "aes-256-ctr";
const SECRET = Buffer.from(process.env.KEY_SECRET, "hex");

export const encrypt = (text) => {
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv(ALGO, SECRET, iv);
  const encrypted = Buffer.concat([cipher.update(text), cipher.final()]);
  return iv.toString("hex") + ":" + encrypted.toString("hex");
};

export const decrypt = (hash) => {
  const [iv, content] = hash.split(":");
  const decipher = crypto.createDecipheriv(
    ALGO,
    SECRET,
    Buffer.from(iv, "hex"),
  );
  const decrypted = Buffer.concat([
    decipher.update(Buffer.from(content, "hex")),
    decipher.final(),
  ]);
  return decrypted.toString();
};
```

---

## ‚úÖ 9. src/utils/validatePayment.js

```js
// Simplified validation stub
export default function validatePayment(payload) {
  // TODO: Add real payment signature validation (HMAC, etc.)
  return payload && payload.order_id;
}
```

---

## üìÑ 10. README.md (–∫—Ä–∞—Ç–∫–æ)

```
# Game Keys Store Backend

Express + Supabase backend for digital game key distribution.

## Setup
1. cd backend
2. npm install
3. Create `.env` (see .env.example)
4. npm run dev

## Routes
GET    /api/products
POST   /api/order
POST   /api/order/webhook
GET    /api/key/:order_id/redeem
```

---

## üöÄ 1. –°–æ–∑–¥–∞—ë–º –ø—Ä–æ–µ–∫—Ç –≤ Supabase

1. –ó–∞—Ö–æ–¥–∏—à—å –Ω–∞ [https://supabase.com/](https://supabase.com)
2. –õ–æ–≥–∏–Ω–∏—à—å—Å—è —á–µ—Ä–µ–∑ GitHub –∏–ª–∏ Google
3. –ù–∞–∂–∏–º–∞–µ—à—å **"New project"**
4. –í–≤–æ–¥–∏—à—å:
   - **Name:** `game-keys-store`
   - **Password:** (–ª—é–±–æ–π, —Ç–æ–ª—å–∫–æ –Ω–µ —Ç–µ—Ä—è–π ‚Äî –Ω—É–∂–µ–Ω –¥–ª—è SQL-–∫–æ–Ω—Å–æ–ª–∏)
   - **Region:** –±–ª–∏–∂–∞–π—à—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, ‚ÄúEU Central‚Äù)

5. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è ‚Üí –∑–∞—Ö–æ–¥–∏—à—å –≤–æ –≤–∫–ª–∞–¥–∫—É **Project Settings ‚Üí API**
   - –ö–æ–ø–∏—Ä—É–µ—à—å:
     - `Project URL` ‚Üí —ç—Ç–æ `SUPABASE_URL`
     - `anon key` ‚Üí –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞ (—á—Ç–µ–Ω–∏–µ)
     - `service_role key` ‚Üí –¥–ª—è –±–µ–∫–µ–Ω–¥–∞ (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å/—É–¥–∞–ª–µ–Ω–∏–µ)

---

## ‚öôÔ∏è 2. –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—ã

–ü–µ—Ä–µ–π–¥–∏ –≤–æ –≤–∫–ª–∞–¥–∫—É **SQL Editor ‚Üí New Query**, –∏ –≤—Å—Ç–∞–≤—å –≤–æ—Ç —ç—Ç–æ—Ç SQL:

```sql
-- üéÆ PRODUCTS TABLE
create table products (
  id serial primary key,
  name text not null,
  slug text unique,
  price numeric(10,2) not null,
  image text,
  description text,
  created_at timestamp default now()
);

-- üîë KEYS TABLE
create table keys (
  id serial primary key,
  product_id int references products(id) on delete cascade,
  key_encrypted text not null,
  is_sold boolean default false,
  sold_at timestamp
);

-- üßæ ORDERS TABLE
create table orders (
  id serial primary key,
  product_id int references products(id) on delete set null,
  email text not null,
  status text check (status in ('pending','paid','cancelled')) default 'pending',
  created_at timestamp default now()
);
```

–ù–∞–∂–º–∏ **Run** ‚úÖ
–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã:

- `products` ‚Äî –∏–≥—Ä—ã
- `keys` ‚Äî –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏
- `orders` ‚Äî –∑–∞–∫–∞–∑—ã

---

## üß© 3. –ü—Ä–∏–º–µ—Ä –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### –î–æ–±–∞–≤—å –≤ SQL Editor –ø—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç:

```sql
insert into products (name, slug, price, image, description)
values
('Cyberpunk 2077', 'cyberpunk-2077', 29.99, 'https://example.com/img/cp2077.jpg', 'Futuristic RPG'),
('Elden Ring', 'elden-ring', 49.99, 'https://example.com/img/elden.jpg', 'Open world fantasy action RPG');
```

–¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ REST API –∏–ª–∏ Supabase UI, —á—Ç–æ –∏–≥—Ä—ã –¥–æ–±–∞–≤–∏–ª–∏—Å—å.

---

## üß† 4. –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏

–ü—Ä–∏–º–µ—Ä: –ø—É—Å—Ç—å —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è `encrypt()` (–∏–∑ `crypto.js`).

–û—Ç–∫—Ä–æ–π Node REPL –∏–ª–∏ –º–∏–Ω–∏-—Å–∫—Ä–∏–ø—Ç `encrypt-test.js`:

```js
import dotenv from "dotenv";
dotenv.config();
import { encrypt } from "./src/utils/crypto.js";

console.log(encrypt("AAAAA-BBBBB-CCCCC-DDDDD")); // –ø—Ä–∏–º–µ—Ä –∫–ª—é—á–∞
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ (`node encrypt-test.js`) –ø–æ–ª—É—á–∏—à—å –Ω–µ—á—Ç–æ –≤—Ä–æ–¥–µ:

```
f07a8c4c7dd8a7e1b06e9a1c1e6b41f3:29d9f733a7b2c6dfb4b98c9a6e...
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å –≤—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Supabase:

```sql
insert into keys (product_id, key_encrypted)
values
(1, 'f07a8c4c7dd8a7e1b06e9a1c1e6b41f3:29d9f733a7b2c6dfb4b98c9a6e...');
```

---

## üí∞ 5. –¢–µ—Å—Ç –∑–∞–∫–∞–∑–∞ (—Ä—É—á–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π)

1. **–°–æ–∑–¥–∞—ë—à—å –∑–∞–∫–∞–∑ –≤—Ä—É—á–Ω—É—é**:

   ```sql
   insert into orders (product_id, email, status)
   values (1, 'user@example.com', 'paid');
   ```

2. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç:

   ```
   GET http://localhost:5000/api/key/1/redeem
   ```

   üîπ –ï—Å–ª–∏ –≤—Å—ë –æ–∫ ‚Äî Express —Ä–∞—Å—à–∏—Ñ—Ä—É–µ—Ç –∫–ª—é—á –∏ –≤–µ—Ä–Ω—ë—Ç:

   ```json
   { "key": "AAAAA-BBBBB-CCCCC-DDDDD" }
   ```

3. –í —Ç–∞–±–ª–∏—Ü–µ `keys` –ø–æ–ª–µ `is_sold` —Å—Ç–∞–Ω–µ—Ç `true`.

---

## üß± 6. –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ (–¥–ª—è UI)

| –¢–∞–±–ª–∏—Ü–∞    | –°–≤—è–∑–∞–Ω–∞ —Å                    | –û–ø–∏—Å–∞–Ω–∏–µ             |
| ---------- | ---------------------------- | -------------------- |
| `products` | ‚Äî                            | –ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä          |
| `keys`     | `product_id` ‚Üí `products.id` | –ö–ª—é—á–∏ –∫ –∏–≥—Ä–∞–º        |
| `orders`   | `product_id` ‚Üí `products.id` | –ó–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

---

## üß© 7. –î–æ—Å—Ç—É–ø—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### üîê Policies (RLS)

–û—Ç–∫–ª—é—á–∏ **Row Level Security (RLS)** –Ω–∞ —Å—Ç–∞—Ä—Ç–µ (–∏–Ω–∞—á–µ API –Ω–µ —Å–º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å).
–ü–æ—Ç–æ–º –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞:

- `products`: `SELECT` –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º
- `keys`: —Ç–æ–ª—å–∫–æ `service_role`
- `orders`: —Ç–æ–ª—å–∫–æ `service_role`

**Supabase ‚Üí Table editor ‚Üí Table ‚Üí RLS ‚Üí Disable temporarily**

---

## üß∞ 8. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Express

–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –≤ `.env`:

```bash
SUPABASE_URL=https://xyz.supabase.co
SUPABASE_KEY=your-service-role-key
KEY_SECRET=your_64byte_hex
PORT=5000
```

–ë–µ–∫ —Å—Ä–∞–∑—É –Ω–∞—á–Ω—ë—Ç —Ä–∞–±–æ—Ç–∞—Ç—å ‚Äî –º–æ–∂–µ—à—å –ø—Ä–æ–≤–µ—Ä—è—Ç—å:

```bash
npm run dev
```

‚Üí `GET http://localhost:5000/api/products`
‚Üí `GET http://localhost:5000/api/key/1/redeem`

---

---

## üß± 1. –í–∫–ª—é—á–∞–µ–º RLS

–ó–∞—Ö–æ–¥–∏–º –≤ **Supabase ‚Üí Table editor ‚Üí (–≤—ã–±–∏—Ä–∞–µ–º —Ç–∞–±–ª–∏—Ü—É)** ‚Üí –≤–∫–ª–∞–¥–∫–∞ **RLS (Row Level Security)**
–∏ –∂–º—ë–º **‚ÄúEnable RLS‚Äù** –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã.

–í–∫–ª—é—á–∞–µ–º RLS –Ω–∞ –≤—Å–µ—Ö:
‚úÖ `products`
‚úÖ `keys`
‚úÖ `orders`

---

## üîê 2. Policies (SQL-–∑–∞–ø—Ä–æ—Å—ã)

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞—ë–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏.
–ü–µ—Ä–µ–π–¥–∏ –≤ **SQL Editor ‚Üí New Query** –∏ –≤—Å—Ç–∞–≤—å üëá

---

### üß© `products` ‚Äî –æ—Ç–∫—Ä—ã—Ç–∞—è –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü–∞

```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º –ª—é–±–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
create policy "Allow public read access to products"
on products
for select
using (true);
```

üìò _–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ—Ä–æ–Ω—Ç—É –Ω–∞–ø—Ä—è–º—É—é –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ `anon key`:_

```js
supabase.from("products").select("*");
```

---

### üîë `keys` ‚Äî —Ç–æ–ª—å–∫–æ backend (service_role)

```sql
-- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∫–ª—é—á–∞ (service_role)
create policy "Service role only access to keys"
on keys
for all
using (auth.role() = 'service_role')
with check (auth.role() = 'service_role');
```

üîí _–ù–∏–∫—Ç–æ, –∫—Ä–æ–º–µ —Ç–≤–æ–µ–≥–æ backend-–∞, –Ω–µ —Å–º–æ–∂–µ—Ç –Ω–∏ —á–∏—Ç–∞—Ç—å, –Ω–∏ –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `keys`._

---

### üßæ `orders` ‚Äî —Ç–æ–ª—å–∫–æ backend (service_role)

```sql
-- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è service_role
create policy "Service role only access to orders"
on orders
for all
using (auth.role() = 'service_role')
with check (auth.role() = 'service_role');
```

üß† _–§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ —Å–º–æ–∂–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ ‚Äî –≤—Å—ë –¥–æ–ª–∂–Ω–æ –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ —Ç–≤–æ–π Express API._

---

## ‚öôÔ∏è 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤:

- –ø–æ–ø—Ä–æ–±—É–π –≤ Supabase UI ‚Üí Table editor ‚Üí `orders` ‚Üí **"Try it out"**
  (–≤—ã–±–µ—Ä–∏ ‚Äúanon key‚Äù) ‚Äî —Ç—ã –ø–æ–ª—É—á–∏—à—å **–æ—à–∏–±–∫—É –¥–æ—Å—Ç—É–ø–∞** üõë
- –≤—ã–±–µ—Ä–∏ ‚Äúservice_role key‚Äù ‚Äî –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

–≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, —á–µ–≥–æ –º—ã –¥–æ–±–∏–≤–∞–ª–∏—Å—å.

---

## üåç 4. –ö–∞–∫ —Ç–µ–ø–µ—Ä—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è

| –î–µ–π—Å—Ç–≤–∏–µ            | –ö—Ç–æ –¥–µ–ª–∞–µ—Ç            | –ö–ª—é—á           |
| ------------------- | --------------------- | -------------- |
| –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä | –§—Ä–æ–Ω—Ç (Astro / React) | `anon key`     |
| –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑       | Express backend       | `service_role` |
| –í—ã–¥–∞—Ç—å –∫–ª—é—á         | Express backend       | `service_role` |

---

## üìÑ 5. –ü—Ä–∏–º–µ—Ä: —Ñ—Ä–æ–Ω—Ç —Ç–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–µ–Ω

–§—Ä–æ–Ω—Ç (Astro / React):

```js
// —Ç–æ–ª—å–∫–æ –∫–∞—Ç–∞–ª–æ–≥
const { data: products } = await supabase
  .from("products")
  .select("id, name, price, image, description");
```

–ë—ç–∫—ç–Ω–¥ (Express):

```js
// —Å–µ—Ä–≤–µ—Ä –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ service_role
const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_KEY,
);
```

---

## üß∞ 6. –ë–æ–Ω—É—Å ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—ã–¥–∞—á—É –∫–ª—é—á–µ–π, –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `logs`:

```sql
create table logs (
  id serial primary key,
  action text,
  product_id int references products(id),
  order_id int references orders(id),
  created_at timestamp default now()
);
```

–ê –≤ Express –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∞–π:

```js
await supabase.from("logs").insert({
  action: "KEY_REDEEMED",
  product_id: 1,
  order_id: 23,
});
```

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äú–æ–ø–ª–∞—Ç–∞ ‚Üí –≤—ã–¥–∞—á–∞ –∫–ª—é—á–∞‚Äù

```
[–§—Ä–æ–Ω—Ç–µ–Ω–¥] ‚Äî‚Üí [–ë—ç–∫—ç–Ω–¥ /api/order] ‚Äî‚Üí [–û–ø–ª–∞—Ç–∞ (Stripe, YooKassa...)]
                                    ‚Üì
                              [Webhook -> /api/payment/webhook]
                                    ‚Üì
                         [Mark paid ‚Üí Redeem Key ‚Üí Send Email]
```

---

## ‚öôÔ∏è 1. –®–∞–≥ 1 ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑

–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ (Astro/React):

```js
// src/lib/api.ts
export async function createOrder(productId, email) {
  const res = await fetch("/api/order", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ productId, email }),
  });
  return res.json();
}
```

–¢—ã –≤—ã–∑—ã–≤–∞–µ—à—å —ç—Ç–æ, –∫–æ–≥–¥–∞ —é–∑–µ—Ä –∂–º—ë—Ç ‚ÄúBuy‚Äù ‚Äî –∏ Express —Å–æ–∑–¥–∞—ë—Ç –∑–∞–∫–∞–∑ –≤ Supabase.

---

## üíæ 2. –®–∞–≥ 2 ‚Äî —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/order`

```js
// backend/src/routes/order.js
import express from "express";
import { supabase } from "../services/supabase.js";

const router = express.Router();

// create new order
router.post("/", async (req, res) => {
  const { productId, email } = req.body;

  const { data, error } = await supabase
    .from("orders")
    .insert([{ product_id: productId, email, status: "pending" }])
    .select()
    .single();

  if (error) return res.status(400).json({ error });

  // —Ç—É—Ç –º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É Stripe/YooKassa
  const paymentUrl = `https://example.com/pay?order_id=${data.id}`;

  res.json({ order: data, paymentUrl });
});

export default router;
```

> ‚ö° –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –∑–∞–∫–∞–∑ –≤ —Å—Ç–∞—Ç—É—Å–µ `pending`, –ø–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç –Ω–µ –æ–ø–ª–∞—Ç–∏–ª.

---

## üí∞ 3. –®–∞–≥ 3 ‚Äî —Å–æ–∑–¥–∞—ë–º –æ–ø–ª–∞—Ç—É

### –í–∞—Ä–∏–∞–Ω—Ç 1: **Stripe**

```js
import Stripe from "stripe";
const stripe = new Stripe(process.env.STRIPE_SECRET);

const session = await stripe.checkout.sessions.create({
  payment_method_types: ["card"],
  line_items: [
    {
      price_data: {
        currency: "usd",
        product_data: { name: "Elden Ring" },
        unit_amount: 4999, // –≤ —Ü–µ–Ω—Ç–∞—Ö
      },
      quantity: 1,
    },
  ],
  mode: "payment",
  success_url: "https://your-site.com/success",
  cancel_url: "https://your-site.com/cancel",
  metadata: { order_id: data.id },
});
```

–¢—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å `session.url` ‚Üí –∏ —Ñ—Ä–æ–Ω—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç —é–∑–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É Stripe.

---

## üïµÔ∏è 4. –®–∞–≥ 4 ‚Äî Webhook (—Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ)

–ö–æ–≥–¥–∞ –ø–ª–∞—Ç—ë–∂ –ø—Ä–æ—à—ë–ª, Stripe/YooKassa/–∫—Ä–∏–ø—Ç–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —à–ª—ë—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Ç–≤–æ–π —Å–µ—Ä–≤–µ—Ä:

```
POST /api/payment/webhook
```

–í–æ—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä:

```js
// backend/src/routes/webhook.js
import express from "express";
import { supabase } from "../services/supabase.js";
import { decrypt } from "../utils/crypto.js";

const router = express.Router();

// Webhook handler
router.post("/", express.json(), async (req, res) => {
  const event = req.body;

  try {
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–±—ã—Ç–∏–µ
    if (event.type === "payment_succeeded") {
      const orderId = event.metadata.order_id;

      // 1Ô∏è‚É£ –ú–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å
      await supabase
        .from("orders")
        .update({ status: "paid" })
        .eq("id", orderId);

      // 2Ô∏è‚É£ –ò—â–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–π –∫–ª—é—á
      const { data: key } = await supabase
        .from("keys")
        .select("*")
        .eq("product_id", event.metadata.product_id)
        .eq("is_sold", false)
        .limit(1)
        .single();

      if (!key) throw new Error("No keys available!");

      // 3Ô∏è‚É£ –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –ø—Ä–æ–¥–∞–Ω–Ω—ã–π
      await supabase
        .from("keys")
        .update({ is_sold: true, sold_at: new Date() })
        .eq("id", key.id);

      // 4Ô∏è‚É£ –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º
      const gameKey = decrypt(key.key_encrypted);

      // 5Ô∏è‚É£ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∏—Å—å–º–æ
      console.log(`üéÆ Sent ${gameKey} to ${event.metadata.email}`);

      // 6Ô∏è‚É£ –õ–æ–≥
      await supabase.from("logs").insert({
        action: "KEY_REDEEMED",
        product_id: event.metadata.product_id,
        order_id: orderId,
      });
    }

    res.status(200).send("ok");
  } catch (err) {
    console.error("Webhook error:", err);
    res.status(400).send("Error");
  }
});

export default router;
```

---

## üì¨ 5. –û—Ç–ø—Ä–∞–≤–∫–∞ email —Å –∫–ª—é—á–æ–º

–ò—Å–ø–æ–ª—å–∑—É–π [Resend](https://resend.com) –∏–ª–∏ [Nodemailer](https://nodemailer.com) ‚Äî –æ–±–∞ –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç.

```js
import nodemailer from "nodemailer";

const transporter = nodemailer.createTransport({
  service: "gmail",
  auth: {
    user: process.env.MAIL_USER,
    pass: process.env.MAIL_PASS,
  },
});

await transporter.sendMail({
  from: `"Game Keys" <${process.env.MAIL_USER}>`,
  to: event.metadata.email,
  subject: "üéÆ Your game key is ready!",
  text: `Here‚Äôs your key: ${gameKey}`,
});
```

---

## üåç 6. –î–µ–ø–ª–æ–π –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                  | –ì–¥–µ –¥–µ—Ä–∂–∞—Ç—å      | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                   |
| -------------------------- | ---------------- | ---------------------------- |
| **Supabase**               | supabase.com     | –ë–î –∏ API                     |
| **Backend (Express)**      | Render / Railway | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –∏ –≤–µ–±—Ö—É–∫–æ–≤ |
| **Frontend (Astro/React)** | Netlify / Vercel | –í–∏—Ç—Ä–∏–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞             |

---

## üß© 7. –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Ç–æ–º

- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (`/admin`) –Ω–∞ React Dashboard
- Telegram Bot, –∫–æ—Ç–æ—Ä—ã–π —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ email –ø—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ (GDPR-friendly)
- –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ **CryptoPay / Binance Pay** –¥–ª—è Web3-–ø—Ä–æ–µ–∫—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
